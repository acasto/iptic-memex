<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iptic Memex - Web</title>
    <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="/static/css/main.css?v=3" />
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" id="prism-dark-theme" disabled>
  </head>
  <body>
    <div class="panel-overlay" id="panelOverlay" role="presentation"></div>
    
    <main class="app-container">
      <header class="header">
        <h1>Iptic Memex</h1>
        <div class="status-indicator" role="status" aria-live="polite">
          <div class="status-dot"></div>
          <span id="status">Loading...</span>
        </div>
      </header>

      <div id="log" role="log" aria-live="polite" aria-atomic="false">
        <div id="emptyState" aria-hidden="true">
          <div class="empty-icon">🤖</div>
          <h2>Welcome to Iptic Memex</h2>
          <p>Start a new conversation by typing your message below.</p>
        </div>
        <button id="jumpLatest" title="Jump to latest" aria-label="Jump to latest messages">↓ New messages</button>
      </div>

      <div class="input-section" role="form" aria-labelledby="textbox-label">
        <div class="toolbar" role="toolbar">
          <div class="toolbar-group">
            <button id="newchat" title="New chat" aria-label="Start a new chat">＋ New</button>
            <button id="chats" title="Load a saved chat" aria-label="Open chat loading panel">📂 Load</button>
            <button id="savechat" title="Save current chat" aria-label="Open save chat dialog">💾 Save</button>
            <button id="options" title="Set option" aria-label="Open settings panel">⚙️ Options</button>
            <button id="stop" title="Stop streaming" aria-label="Stop generating response" style="display:none;">■ Stop</button>
          </div>
          
          <div class="spacer"></div>
          
          <div class="toggle-group">
            <label>
              <input id="stream" type="checkbox" />
              Stream
            </label>
            <label title="Toggle dark mode">
              <input id="darkmode" type="checkbox" />
              Dark
            </label>
          </div>
        </div>

        <div id="previews"></div>

        <div class="input-container">
          <label id="textbox-label" for="msg" class="sr-only">Message Input</label>
          <textarea id="msg" placeholder="Type your message..." rows="1" aria-label="Type your message here" aria-multiline="true"></textarea>
          <div class="input-actions">
            <button id="attach" title="Attach files" aria-label="Attach files">📎</button>
            <button id="send" title="Send message" aria-label="Send message">→</button>
          </div>
        </div>
      </div>
    </main>

    <div id="panel" role="dialog" aria-modal="true" aria-hidden="true"></div>

    <!-- Visually hidden styles for screen readers -->
    <style>
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }
    </style>

    <!-- Markdown and syntax highlighting -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script type="module" src="/static/js/main.js?v=3"></script>
  </body>
</html>
